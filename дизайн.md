# UI Design Spec v2.0 (2025) — Облачный AI-SaaS «Мебель-ИИ»

## 0. Дизайн-философия (2025)

- **Информационная плотность и ясность**: Наш пользователь — профессионал. Интерфейс должен быть насыщенным, но не перегруженным. Каждый элемент управления на своем месте, информация легко считывается.
- **Проактивная помощь (AI-First)**: ИИ — не отдельная функция, а ядро продукта. Он предсказывает следующий шаг, предлагает исправления, генерирует варианты и помогает принимать решения, а не просто реагирует на команды.
- **Безупречная производительность**: Интерфейс должен быть мгновенным. Все операции, от рендеринга таблиц до 3D-просмотра, оптимизированы для плавной работы.
- **Утонченная материальность**: Мы создаем ощущение глубины и иерархии с помощью мягких градиентов, тонких границ и акцентных теней. Вместо рискованного «глассморфизма» — зрелый, доступный подход к многослойности.

---

## 1. Технологический стек фронтенда

- **Компоненты**: **Radix UI** + **Tailwind CSS**. Мы используем `shadcn/ui` как стартовый набор для быстрого развертывания кастомных, полностью контролируемых и доступных (WAI-ARIA) компонентов.
- **Анимация**: **Framer Motion** для всех UI-переходов, состояний и микро-взаимодействий.
- **3D-визуализация**: **React Three Fiber (`@react-three/fiber`)** для интерактивного предпросмотра CAD-моделей.
- **Визуализация данных**: **Recharts** или **Visx** для построения кастомных дашбордов и отчетов.
- **Управление состоянием**: React Query / TanStack Query для серверного состояния, Zustand/Jotai для UI.

---

## 2. Информационная архитектура (IA)

*Без изменений, структура логична.*

**Разделы:**
1) Главная (Дашборд); 2) Заказы; 3) Спецификация (BOM); 4) Фурнитура (RAG-подбор); 5) CAM (DXF/G-code); 6) Интеграции (1С); 7) История заказов; 8) Аудит (для администраторов); 9) Настройки.

**Навигация:** левое док-меню (иконка + лейбл), «действие дня» — primary CTA в app bar.
**Глобальный поиск (⌘/Ctrl-K)**: AI-powered, обрабатывает запросы вроде «все заказы с фурнитурой Blum за прошлый месяц».

---

## 3. Ключевые паттерны и страницы

### 3.5 История и Аудит (по ролям)
Вместо прямого отображения технических логов, реализуется двухуровневая система:
- **Для технолога**: Внутри карточки каждого заказа будет доступна контекстная «История заказа» — человекочитаемый список ключевых событий (загрузка ТЗ, согласование параметров, запуск CAM и т.д.). Это обеспечивает прозрачность без перегрузки интерфейса.
- **Для администратора**: Предусмотрен отдельный раздел «Аудит», доступный только пользователям с соответствующими правами. Он будет содержать детальные журналы действий, системные события и ошибки для полноценного контроля и администрирования платформы.

### 3.1 Dashboard
- **Bento-грид**: остается, но с возможностью **кастомизации** пользователем (drag-and-drop). Технолог сам решает, какие виджеты ему важнее.
- **Виджеты**:
  - «Создать заказ из ТЗ» (primary).
  - «Активные заказы» (интерактивная таблица `TanStack Table`).
  - «Очередь CAM» (статусы в реальном времени, ETA).
  - **«AI-ассистент»**: виджет с проактивными предложениями («Найдено 3 заказа с похожими параметрами. Объединить спецификации?»).

### 3.2 Заказ (Wizard, 4 шага)
1.  **ТЗ**: Загрузка ТЗ (текст, эскиз). AI в реальном времени анализирует входные данные.
2.  **Диалог и валидация**: Вместо статической формы — **диалоговый интерфейс** с ИИ-технологом для уточнения и финализации параметров. (См. паттерн 3.4)
3.  **Спецификация (BOM)**: ИИ предлагает варианты фурнитуры на основе утвержденных параметров.
4.  **CAM**: Запуск генерации файлов для станков.

### 3.3 Фурнитура (RAG-подбор)
- **AI-объяснения**: не просто текст, а структурированный блок с плюсами, минусами и **уровнем уверенности ИИ**.
- **Визуальное сравнение**: возможность выбрать 2-3 элемента фурнитуры и сравнить их характеристики в модальном окне.

### 3.4 Паттерн: Диалог с ИИ-технологом
Это ключевой этап взаимодействия, заменяющий ручную проверку.
- **Интерфейс**: Чат-компонент, построенный с помощью **Vercel AI SDK**. Ответы от ИИ появляются в потоковом режиме.
- **Системная роль ИИ**: "Ты — ведущий технолог мебельного производства. Твоя задача — проанализировать извлеченные из ТЗ параметры и задать пользователю уточняющие вопросы, чтобы исключить ошибки. Спрашивай про материалы, кромку, присадки, фурнитуру, если видишь неполные или неоднозначные данные. Веди диалог до тех пор, пока все параметры не будут финализированы."
- **Интерактивные элементы**: ИИ может отправлять не только текст, но и кнопки с вариантами ответов («Да, использовать кромку 2мм», «Нет, указать другую»), чтобы ускорить процесс согласования.
- **Завершение**: Диалог завершается, когда ИИ собрал все необходимые данные, или по команде пользователя. Финальные, согласованные параметры становятся основой для следующих этапов.

### 3.6 Публичные страницы и онбординг
- **Лендинг**: Главная страница продукта, описывающая его ценность, возможности и преимущества. Должна содержать понятные CTA (Call to Action) для регистрации или просмотра тарифов.
- **Страница тарифов**: Ясное и наглядное представление тарифных планов, их стоимости и входящих в них лимитов/функций.
- **Страницы аутентификации**: Современные и минималистичные формы для входа, регистрации и восстановления пароля. Предпочтительно реализовать в виде модальных окон поверх лендинга или на отдельных страницах.

### 3.7 Настройки пользователя
- **Доступ**: Меню настроек должно открываться по клику на email/аватар пользователя в правом верхнем углу приложения.
- **Реализация**: В виде выпадающего меню (Dropdown Menu) или отдельной страницы, включающей управление профилем, сменой пароля и настройками уведомлений.

---

## 4. Дизайн-система (Foundations → Components → Patterns)

### 4.1 Foundations (Design Tokens)
*Подход с токенами верный, но конкретизируем для новой системы.*
| Токен | Ключ | Значение/Правило |
|---|---|---|
| Цвет | `color.brand.primary`, `color.bg.canvas` | Палитра генерируется из базового цвета с помощью инструментов типа `radix-colors`. |
| Радиусы | `radius.2...16` | Шаг в 2px, позволяет создавать от строгих до скругленных интерфейсов. |
| Тени | `shadow.sm...xl` | Набор из 5 теней для создания иерархии и глубины. |
| Типографика | `font.sans`, `font.mono` | **Шрифт: Inter (variable)**. Табличные цифры включены. |
| Пробелы | `space.1...64` | Степенная шкала (4, 8, 12, 16, 24, 32...). |
| Анимация | `motion.duration`, `motion.easing` | Токены для скорости и кривых Безье (`ease-in-out`, `ease-out-expo`). |

**Автоматизация**: Токены синхронизируются из Figma в код через **Tokens Studio** или **Style Dictionary**.

### 4.2 Компоненты
*Список остается релевантным, но все компоненты строятся на базе Radix UI.*
- **Таблицы**: Используем **TanStack Table** для сложных таблиц (сортировка, фильтрация, виртуализация) и стилизуем через Tailwind.
- **Интерактивные элементы**: Все кнопки, поля ввода, селекты имеют четкие `focus`, `hover`, `active`, `disabled` состояния, анимированные с помощью `Framer Motion`.

---

## 5. Гайд по движению (Motion)

- **Принцип**: Анимация должна быть функциональной — информировать, направлять и подтверждать действия.
- **Layout-переходы**: Плавное анимирование списков (например, очередь CAM) при добавлении/удалении элементов с помощью `Framer Motion` (`AnimatePresence`).
- **Shared Layout Animations**: При переходе от списка заказов к детальной странице — плавная трансформация элемента списка в заголовок страницы.
- **Микро-взаимодействия**: Иконки и кнопки слегка меняют масштаб или поворачиваются при наведении. Прогресс-бары имеют тонкую градиентную анимацию.
- **Состояния загрузки**: Вместо простых скелетонов — **размытые превью** (`blurhash`) для изображений и 3D-моделей, где это возможно.

---

## 6. Доступность (Accessibility, A11y)

- **Контрастность**: Строгое соблюдение WCAG AA (4.5:1), особенно для «материальных» слоев.
- **Навигация с клавиатуры**: Полная поддержка для всех интерактивных элементов. Особое внимание на управление фокусом в модальных окнах и визардах.
- **ARIA**: Корректное использование `aria-*` атрибутов для сложных компонентов (таблицы, табы, карусели). ARIA live regions для асинхронных обновлений (статус CAM).
- **Тестирование**: Регулярное тестирование с помощью скринридеров (NVDA, VoiceOver).

---

## 7. Структура Figma-файла

*Структура отличная, добавляем конкретики по инструментам.*
- **Токены**: Управляются через плагин **Tokens Studio** (бывший Figma Tokens) для экспорта в кодовую базу.
- **Компоненты**: Построены с использованием Variants и Component Properties для максимальной гибкости.
- **Dev Mode**: Активно используется для передачи спецификаций разработчикам. Названия слоев и токенов должны быть идентичны коду.

---

## 8. Референсы и Вдохновение

Этот раздел закрепляет ключевые внешние референсы, которые формируют наше видение продукта и подтверждают правильность выбранных дизайн-паттернов.

### 8.1 Эталоны B2B SaaS
- **Linear.app**: "Северная звезда" нашего UX. Образец скорости, минимализма и эффективности. Мы стремимся к такой же отточенности в каждом взаимодействии.
- **Vercel.com**: Пример чистого, информативного дашборда для сложного технического продукта. Отличный референс для нашего bento-грида.
- **Stripe.com**: Эталон баланса между безупречной эстетикой (анимации, градиенты) и абсолютной функциональностью в B2B-сегменте.

### 8.2 Аналоги в производственном и CAD/CAM ПО
- **Onshape.com** и **Fusion 360 (Web)**: Прямые референсы для интерфейса работы с 3D-моделями, панелей инструментов и инспекторов свойств. Их опыт в облачном CAD бесценен.
- **Tulip.co** и **Katana MRP**: Современные MRP/MES-платформы. У них стоит подсмотреть организацию дашбордов с производственными KPI, управление очередью заказов и работу с табличными данными.

### 8.3 Взаимодействие с ИИ
- **Notion AI / Figma AI**: Примеры того, как ИИ-функции органично встраиваются в основной рабочий процесс, а не существуют в отдельном окне.
- **RunwayML**: Референс для генеративных интерфейсов, где пользователь управляет сложным процессом через структурированные формы и настройки, сохраняя контроль.

### 8.4 Визуальные и трендовые ориентиры
- **Awwwards.com**: Постоянный источник вдохновения для поиска смелых визуальных решений, продвинутой анимации и инновационных UI-паттернов.
- **Официальный сайт Material 3**: Первоисточник для всех компонентов и принципов, особенно в части динамических цветов и выразительного дизайна.

---

## 9. Администрирование и Наблюдение

Для задач администрирования, управления данными (пользователи, заказы, справочники) и базового мониторинга вместо создания отдельного фронтенд-приложения используется подход "Admin-as-a-library".

- **Технология**: **SQLAdmin** для FastAPI.
- **Принцип работы**: Библиотека автоматически генерирует полнофункциональный и защищенный веб-интерфейс на основе моделей данных SQLAlchemy.
- **Доступ**: Панель администратора будет доступна по эндпоинту `/admin` в основном `api` приложении и защищена схемой аутентификации, доступной только пользователям с ролью "администратор".

Этот подход позволяет получить мощный инструмент управления с минимальными трудозатратами на разработку и поддержку.

---
*Разделы 7 (Флоу-эскизы), 8 (Контент-правила) и 9 (Контроль качества) остаются актуальными. Раздел 10 (Референсы) обновлен неявно через весь документ.*